{
  "rules": {
    ".read": "auth != null",
    ".write": "auth != null",
    "canvases": {
      "$canvasId": {
        ".read": "auth != null",
        ".write": "auth != null && (!data.exists() || data.child('ownerId').val() == auth.uid || !data.hasChild('ownerId'))",
        "lastOpenedBy": {
          "$userId": {
            ".read": "auth != null",
            ".write": "auth != null"
          }
        }
      }
    },
    "objects": {
      "$canvasId": {
        "$objectId": {
          ".read": "auth != null",
          ".write": "auth != null",
          ".validate": "(!data.exists() && newData.hasChildren(['id', 'type', 'createdBy', 'createdAt', 'updatedAt'])) || (data.exists() && newData.hasChildren(['id', 'type', 'createdBy', 'createdAt'])) && (newData.child('type').val() == 'rectangle' || newData.child('type').val() == 'circle' || newData.child('type').val() == 'line' || newData.child('type').val() == 'text')",
          "id": { ".validate": "newData.isString()" },
          "type": { ".validate": "newData.isString() && (newData.val() == 'rectangle' || newData.val() == 'circle' || newData.val() == 'line' || newData.val() == 'text')" },
          "createdBy": { ".validate": "newData.isString()" },
          "createdAt": { ".validate": "newData.isNumber()" },
          "updatedAt": { ".validate": "newData.isNumber()" },
          "x": { ".validate": "newData.isNumber()" },
          "y": { ".validate": "newData.isNumber()" },
          "width": { ".validate": "newData.isNumber()" },
          "height": { ".validate": "newData.isNumber()" },
          "centerX": { ".validate": "newData.isNumber()" },
          "centerY": { ".validate": "newData.isNumber()" },
          "radius": { ".validate": "newData.isNumber()" },
          "text": { ".validate": "newData.isString()" },
          "fontSize": { ".validate": "newData.isNumber()" },
          "fill": { ".validate": "newData.isString()" },
          "stroke": { ".validate": "newData.isString()" },
          "strokeWidth": { ".validate": "newData.isNumber()" },
          "bold": { ".validate": "newData.isBoolean()" },
          "italic": { ".validate": "newData.isBoolean()" },
          "underline": { ".validate": "newData.isBoolean()" },
          "rotation": { ".validate": "newData.isNumber()" },
          "updatedBy": { ".validate": "newData.isString()" },
          "$other": { ".validate": false }
        }
      }
    },
    "presence": {
      "$canvasId": {
        "$userId": {
          ".read": "auth != null",
          ".write": "$userId === auth.uid"
        }
      }
    },
    "users": {
      "$userId": {
        ".read": "auth != null",
        ".write": "$userId === auth.uid"
      }
    }
  }
}


